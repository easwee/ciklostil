---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import FormattedDate from "@/components/FormattedDate.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "@/consts";
import BaseLayout from "@/layouts/BaseLayout.astro";

const posts = (await getCollection("blog")).sort(
	(a, b) => b.data.created_at.valueOf() - a.data.created_at.valueOf(),
);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<section>
		{
			posts.map((post) => (
				<div>
					<a href={`/blog/${post.id}/`}>
						{post.data.poster && (
							<Image width={720} height={360} src={post.data.poster} alt="" />
						)}
						<h4 class="title">{post.data.title}</h4>
						<p class="date">
							<FormattedDate date={post.data.created_at} />
						</p>
					</a>
				</div>
			))
		}
	</section>
</BaseLayout>
